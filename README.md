# Имитация сценария централизованных платежей с использованием СУБД YDB

Приложение имитирует сценарий выполнения централизованных платежей:
* в системе открыто большое количество обычных счетов и два суперсчёта: консолидирующий и распределительный;
* с обычных счетов выполняются транзакции по переводу средств на консолидирующий суперсчёт;
* с распределительного суперсчёта выполняются транзакции по переводу средств на обычные счета;
* периодически выполняется проверка соотношения средств на консолидирующем и распределительном суперсчетах: если средств на консолидирующем оказывается в 4 раза больше, чем на распределительном, то 75% их переводится на распределительный суперсчет.

Состав таблиц:
* `account` - справочник счетов;
* `saldo` - состояния и обороты по счетам;
* `transaction` - операции перевода средств;
* `inbox` - таблица регистрации платежей;
* `oporder` - вспомогательная таблица для упорядочения исходящих платежей.

Каждый платёж проводится в две транзакции:
* транзакция регистрации: платёж регистрируется `inbox`, ему присваивается первичный порядковый номер в рамках счёта плательщика;
* транзакция проведения: проверяется правильность счетов, достаточность средств на счёте плательщика, присваиваются порядковые номера проведения в рамках счетов плательщика и получателя, корректируются значения сальдо и оборотов по счетам, запись переносится из `inbox` в `transaction`.

Транзакции регистрации и проведения могут группироваться так, что за одну транзакцию СУБД обрабатывается несколько платежей.
